{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/khami/OneDrive/Desktop/%D0%B1%D0%B5%D0%B7%D0%B4%D0%B2%D0%B8%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F2/immobility2/client/app/chat/page.tsx"],"sourcesContent":["'use client'\r\nimport socket from '@/app/socket';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '@/app/redux/store';\r\n\r\nimport './style.scss'\r\ninterface Message {\r\n    name: string;\r\n    msg: string;\r\n}\r\n\r\nconst Chat = () => {\r\n\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n    const router = useRouter()\r\n    const { localName } = useSelector((state: RootState) => state.data);\r\n    const [localMessage, setLocalMessage] = useState<string>('');\r\n    const [history, setHistory] = useState<Message[]>([])\r\n    const StandardMessages: string[] = ['Хочу Музыку', 'Как дела?'];\r\n    const [inputActive, setInputActive] = useState<boolean>(false)\r\n    const messagesEndRef = useRef<HTMLDivElement | null>(null);\r\n\r\n\r\n\r\n    const sendMessage = () => {\r\n        if (!localMessage.trim()) {\r\n            return;\r\n        }\r\n        socket.emit('sendMessae', { name: localName, msg: localMessage })\r\n        setLocalMessage('')\r\n        setHistory(prevHistory => {\r\n            if (prevHistory.length > 10) {\r\n                return prevHistory.slice(1); // Удаляем первое сообщение\r\n            }\r\n            return prevHistory;\r\n        });\r\n    }\r\n\r\n    const generatePredefinedMessages = (item: string) => {\r\n        setLocalMessage(item)\r\n    }\r\n    const getLiveMessages = () => {\r\n        socket.on('liveMsg', (msg) => {\r\n            setHistory((prew) => [...prew, msg])\r\n        })\r\n    };\r\n    const isMusicMessagePresent = history.some((item) => item.msg === 'Хочу Музыку');\r\n\r\n    useEffect(() => {\r\n        if (audioRef.current && isMusicMessagePresent) {\r\n            audioRef.current.play();\r\n        }\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    }, [history, isMusicMessagePresent]);\r\n\r\n    useEffect(() => {\r\n        getLiveMessages()\r\n        if (!localName) {\r\n            router.push('/');\r\n        }\r\n\r\n        socket.on('currentUser', data => {\r\n            if (data <= 1) {\r\n                router.push('/loader')\r\n            }\r\n        })\r\n        return () => {\r\n            socket.off('currentUser')\r\n            socket.off('liveMsg');\r\n            socket.emit('chat_leave', localName)\r\n        }\r\n    }, [router, localName]);\r\n\r\n    const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (event.key === \"Enter\") {\r\n            event.preventDefault();\r\n            sendMessage();\r\n        }\r\n    };\r\n\r\n    return (\r\n        localName ? (\r\n            <>\r\n                <div className=\"chat-container\">\r\n                    <div className=\"container\">\r\n                        <div className=\"chat\">\r\n                            <div className=\"set-message\">\r\n                                <audio ref={audioRef}>\r\n                                    <source src='https://zaycev.europium.zerocdn.com/bc43a68fa9baa2a25fa99e1933b20e4b:2025012512/track/24881994.mp3' type=\"audio/mp3\" />\r\n                                    Ваш браузер не поддерживает элемент audio.\r\n                                </audio>\r\n                                <div className=\"message\">\r\n                                    <span className=\"\">Администратор</span>\r\n                                    <span className=\"\">Моменты первого контакта могут изменить вашу жизнь. Сделайте этот первый шаг и отправьте сообщение.</span>\r\n                                    {\r\n                                        <div>\r\n                                            {\r\n                                                StandardMessages.map((item, index) => <span key={index} onClick={() => generatePredefinedMessages(item)} className='music'>{item}</span>)\r\n                                            }\r\n                                        </div>\r\n                                    }\r\n                                </div>\r\n                                {\r\n\r\n                                    history.map((item, index) => {\r\n                                        return (\r\n                                            <>\r\n                                                <div ref={messagesEndRef} key={index} className=\"message\">\r\n                                                    <span className=\"textUser\">{item.name}</span>\r\n                                                    <span className=\"\">{item.msg}</span>\r\n                                                </div>\r\n                                            </>\r\n                                        )\r\n                                    })\r\n                                }\r\n                            </div>\r\n                            <form className=\"chat-form\" action=\"\">\r\n                                <input\r\n                                    onChange={(e) => setLocalMessage(e.target.value)}\r\n                                    onClick={() => setInputActive(true)}\r\n                                    className={`text-input ${inputActive ? 'sizeText' : ''}`}\r\n                                    type=\"text\" placeholder=\"Введите ваше сообшение\"\r\n                                    onKeyDown={(event) => handleKeyDown(event)}\r\n                                    value={localMessage}\r\n                                />\r\n\r\n                                <input onClick={() => sendMessage()} className=\"submit-button\" type=\"button\" value=\"Отправить\" />\r\n\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        ) : null\r\n\r\n    )\r\n}\r\nexport default Chat;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}